function g(t,e,r,i){function n(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(d){try{h(i.next(d))}catch(p){s(p)}}function u(d){try{h(i.throw(d))}catch(p){s(p)}}function h(d){d.done?o(d.value):n(d.value).then(a,u)}h((i=i.apply(t,[])).next())})}function y(t,e,r,i){if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?i:r==="a"?i.call(t):i?i.value:e.get(t)}function re(t,e){if(!t)throw new Error(e)}var K;(function(t){t.prod="BLOCTO_SDK",t.dev="BLOCTO_SDK_DEV",t.staging="BLOCTO_SDK_STAGING"})(K||(K={}));var b;(function(t){t.ETHEREUM="ethereum",t.APTOS="aptos"})(b||(b={}));const Ae={56:"https://bsc-dataseed1.binance.org",97:"https://data-seed-prebsc-1-s1.binance.org:8545",137:"https://rpc-mainnet.maticvigil.com/",80002:"https://rpc-amoy.polygon.technology/",43114:"https://api.avax.network/ext/bc/C/rpc",43113:"https://api.avax-test.network/ext/bc/C/rpc",42161:"https://arb1.arbitrum.io/rpc",421614:"https://arbitrum-sepolia.blockpi.network/v1/rpc/public",10:"https://mainnet.optimism.io",11155420:"https://sepolia.optimism.io",8453:"https://mainnet.base.org",84532:"https://sepolia.base.org",7777777:"https://rpc.zora.energy",999999999:"https://sepolia.rpc.zora.energy",534352:"https://rpc.scroll.io",534351:"https://sepolia-rpc.scroll.io",59144:"https://rpc.linea.build",1261120:"https://rpc.startale.com/zkatana",81457:"https://rpc.blast.io",168587773:"https://sepolia.blast.io"},ke={prod:"https://wallet-v2.blocto.app",staging:"https://wallet-v2-staging.blocto.app",dev:"https://wallet-v2-dev.blocto.app"},Ir={prod:K.prod,staging:K.staging,dev:K.dev},Rr={1:K.prod,2:K.dev,3:K.dev,4:K.dev,5:K.staging},Pr={1:"https://wallet-v2.blocto.app",2:"https://wallet-v2-dev.blocto.app",3:"https://wallet-v2-dev.blocto.app",4:"https://wallet-v2-dev.blocto.app",5:"https://wallet-v2-staging.blocto.app"};var X;(function(t){t.Mainnet="mainnet",t.Testnet="testnet",t.Devnet="devnet",t.Testing="testing",t.Premainnet="premainnet"})(X||(X={}));const Tr={1:X.Mainnet,2:X.Testnet,3:X.Devnet,4:X.Testing,5:X.Premainnet},Cr={1:"https://fullnode.mainnet.aptoslabs.com/v1",2:"https://fullnode.testnet.aptoslabs.com/v1",3:"https://fullnode.devnet.aptoslabs.com/v1",4:"",5:"https://premainnet.aptosdev.com/v1"},$e=["connect","disconnect","message","chainChanged","accountsChanged"],Or=86400*1e3,Fe="00000000-0000-0000-0000-000000000000",ge="0.10.2";class Xe{constructor(){this.isBlocto=!0,this.isConnecting=!1,this.eventListeners={},this.off=this.removeListener,$e.forEach(e=>{this.eventListeners[e]=[]}),this.appId=Fe}request(e){return g(this,void 0,void 0,function*(){})}on(e,r){$e.includes(e)&&this.eventListeners[e].push(r)}once(){}removeListener(e,r){const n=this.eventListeners[e].findIndex(o=>o===r);n!==-1&&this.eventListeners[e].splice(n,1)}}const Fr="width:100vw;height:100%;position:fixed;top:0;left:0;z-index:2147483646;border:none;box-sizing:border-box;color-scheme:light;inset:0px;display:block;pointer-events:auto;";function he(t){const e=document.createElement("iframe");return e.setAttribute("src",t),e.setAttribute("style",Fr),e}function de(t){document.body.appendChild(t)}function F(t){const e=t&&t.parentNode;e&&e.removeChild instanceof Function&&e.removeChild(t)}var J=(t,e,r=window)=>{function i(n){e(n,()=>r.removeEventListener(t,i))}r.addEventListener(t,i)};const Nr=()=>{if(typeof window>"u")return!1;try{window.sessionStorage.setItem("local_storage_supported","1");const t=window.sessionStorage.getItem("local_storage_supported");return window.sessionStorage.removeItem("local_storage_supported"),t==="1"}catch{return!1}};class Dr{constructor(){this.storage={}}getItem(e){return this[e]||null}setItem(e,r){this.storage[e]=r}removeItem(e){delete this.storage[e]}}const Mr=typeof window<"u"?window.memoryStorage:new Dr,Ne=Nr()?window.sessionStorage:Mr,De=(t,e=null)=>{const r=Ne.getItem(t);try{return r&&JSON.parse(r)||e}catch{return r||e}},Me=(t,e)=>Ne.setItem(t,typeof e=="string"?e:JSON.stringify(e)),we=t=>{Me(t,""),Ne.removeItem(t)},G=t=>{const e=De(t,null);return e?new Date().getTime()>e.expiry||e.v!==ge?(we(t),null):e?.data:null},ie=(t,e,r)=>{var i,n,o;const s=De(t),a={data:{code:e?.code||((i=s?.data)===null||i===void 0?void 0:i.code),accounts:Object.assign(Object.assign({},(n=s?.data)===null||n===void 0?void 0:n.accounts),e?.accounts),evm:Object.assign(Object.assign({},(o=s?.data)===null||o===void 0?void 0:o.evm),e?.evm)},expiry:r||s?.expiry||new Date().getTime()+Or,v:ge};Me(t,a)},k=(t,e)=>{var r,i,n;return!((r=G(t))===null||r===void 0)&&r.code?((n=(i=G(t))===null||i===void 0?void 0:i.accounts)===null||n===void 0?void 0:n[e])||null:(we(t),null)},Br=(t,e,r)=>{ie(t,{accounts:{[e]:r}})},Ur=(t,e)=>{ie(t,{accounts:{[e]:void 0}})},ne=(t,e)=>{var r,i,n;return!((r=G(t))===null||r===void 0)&&r.code?((n=(i=G(t))===null||i===void 0?void 0:i.evm)===null||n===void 0?void 0:n[e])||null:(we(t),null)},qe=(t,e,r)=>{ie(t,{evm:{[e]:r}})},Ve=t=>{const e=De(t);e&&(e.data.evm={},Me(t,e))};function le(t,e,r){return g(this,void 0,void 0,function*(){if((t.status===403||t.status===401)&&(r&&r(),we(e)),!t.ok){const i=yield t.json(),n=new Error(i?.message||"unknown error");throw n.error_code=i?.error_code,n}return t.json()})}const Ye=t=>/\S+@\S+\.\S+/.test(t);var se;(function(t){t.INVALID_TRANSACTION="Invalid transaction",t.INVALID_TRANSACTIONS="Invalid transactions",t.INVALID_TRANSACTION_VALUE='Transaction params "value" should be hex-encoded string'})(se||(se={}));var ze=typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{},$=[],B=[],Kr=typeof Uint8Array<"u"?Uint8Array:Array,Be=!1;function Ze(){Be=!0;for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0,r=t.length;e<r;++e)$[e]=t[e],B[t.charCodeAt(e)]=e;B[45]=62,B[95]=63}function Lr(t){Be||Ze();var e,r,i,n,o,s,a=t.length;if(a%4>0)throw new Error("Invalid string. Length must be a multiple of 4");o=t[a-2]==="="?2:t[a-1]==="="?1:0,s=new Kr(a*3/4-o),i=o>0?a-4:a;var u=0;for(e=0,r=0;e<i;e+=4,r+=3)n=B[t.charCodeAt(e)]<<18|B[t.charCodeAt(e+1)]<<12|B[t.charCodeAt(e+2)]<<6|B[t.charCodeAt(e+3)],s[u++]=n>>16&255,s[u++]=n>>8&255,s[u++]=n&255;return o===2?(n=B[t.charCodeAt(e)]<<2|B[t.charCodeAt(e+1)]>>4,s[u++]=n&255):o===1&&(n=B[t.charCodeAt(e)]<<10|B[t.charCodeAt(e+1)]<<4|B[t.charCodeAt(e+2)]>>2,s[u++]=n>>8&255,s[u++]=n&255),s}function jr(t){return $[t>>18&63]+$[t>>12&63]+$[t>>6&63]+$[t&63]}function kr(t,e,r){for(var i,n=[],o=e;o<r;o+=3)i=(t[o]<<16)+(t[o+1]<<8)+t[o+2],n.push(jr(i));return n.join("")}function Je(t){Be||Ze();for(var e,r=t.length,i=r%3,n="",o=[],s=16383,a=0,u=r-i;a<u;a+=s)o.push(kr(t,a,a+s>u?u:a+s));return i===1?(e=t[r-1],n+=$[e>>2],n+=$[e<<4&63],n+="=="):i===2&&(e=(t[r-2]<<8)+t[r-1],n+=$[e>>10],n+=$[e>>4&63],n+=$[e<<2&63],n+="="),o.push(n),o.join("")}function Ee(t,e,r,i,n){var o,s,a=n*8-i-1,u=(1<<a)-1,h=u>>1,d=-7,p=r?n-1:0,f=r?-1:1,l=t[e+p];for(p+=f,o=l&(1<<-d)-1,l>>=-d,d+=a;d>0;o=o*256+t[e+p],p+=f,d-=8);for(s=o&(1<<-d)-1,o>>=-d,d+=i;d>0;s=s*256+t[e+p],p+=f,d-=8);if(o===0)o=1-h;else{if(o===u)return s?NaN:(l?-1:1)*(1/0);s=s+Math.pow(2,i),o=o-h}return(l?-1:1)*s*Math.pow(2,o-i)}function Qe(t,e,r,i,n,o){var s,a,u,h=o*8-n-1,d=(1<<h)-1,p=d>>1,f=n===23?Math.pow(2,-24)-Math.pow(2,-77):0,l=i?0:o-1,v=i?1:-1,w=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=d):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),s+p>=1?e+=f/u:e+=f*Math.pow(2,1-p),e*u>=2&&(s++,u/=2),s+p>=d?(a=0,s=d):s+p>=1?(a=(e*u-1)*Math.pow(2,n),s=s+p):(a=e*Math.pow(2,p-1)*Math.pow(2,n),s=0));n>=8;t[r+l]=a&255,l+=v,a/=256,n-=8);for(s=s<<n|a,h+=n;h>0;t[r+l]=s&255,l+=v,s/=256,h-=8);t[r+l-v]|=w*128}var $r={}.toString,er=Array.isArray||function(t){return $r.call(t)=="[object Array]"};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */var qr=50;c.TYPED_ARRAY_SUPPORT=ze.TYPED_ARRAY_SUPPORT!==void 0?ze.TYPED_ARRAY_SUPPORT:!0;pe();function pe(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function Y(t,e){if(pe()<e)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e),t.__proto__=c.prototype):(t===null&&(t=new c(e)),t.length=e),t}function c(t,e,r){if(!c.TYPED_ARRAY_SUPPORT&&!(this instanceof c))return new c(t,e,r);if(typeof t=="number"){if(typeof e=="string")throw new Error("If encoding is specified then the first argument must be a string");return Ue(this,t)}return rr(this,t,e,r)}c.poolSize=8192;c._augment=function(t){return t.__proto__=c.prototype,t};function rr(t,e,r,i){if(typeof e=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer?zr(t,e,r,i):typeof e=="string"?Yr(t,e,r):Jr(t,e)}c.from=function(t,e,r){return rr(null,t,e,r)};c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,typeof Symbol<"u"&&Symbol.species&&c[Symbol.species]);function tr(t){if(typeof t!="number")throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function Vr(t,e,r,i){return tr(e),e<=0?Y(t,e):r!==void 0?typeof i=="string"?Y(t,e).fill(r,i):Y(t,e).fill(r):Y(t,e)}c.alloc=function(t,e,r){return Vr(null,t,e,r)};function Ue(t,e){if(tr(e),t=Y(t,e<0?0:Ke(e)|0),!c.TYPED_ARRAY_SUPPORT)for(var r=0;r<e;++r)t[r]=0;return t}c.allocUnsafe=function(t){return Ue(null,t)};c.allocUnsafeSlow=function(t){return Ue(null,t)};function Yr(t,e,r){if((typeof r!="string"||r==="")&&(r="utf8"),!c.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var i=ir(e,r)|0;t=Y(t,i);var n=t.write(e,r);return n!==i&&(t=t.slice(0,n)),t}function xe(t,e){var r=e.length<0?0:Ke(e.length)|0;t=Y(t,r);for(var i=0;i<r;i+=1)t[i]=e[i]&255;return t}function zr(t,e,r,i){if(e.byteLength,r<0||e.byteLength<r)throw new RangeError("'offset' is out of bounds");if(e.byteLength<r+(i||0))throw new RangeError("'length' is out of bounds");return r===void 0&&i===void 0?e=new Uint8Array(e):i===void 0?e=new Uint8Array(e,r):e=new Uint8Array(e,r,i),c.TYPED_ARRAY_SUPPORT?(t=e,t.__proto__=c.prototype):t=xe(t,e),t}function Jr(t,e){if(q(e)){var r=Ke(e.length)|0;return t=Y(t,r),t.length===0||e.copy(t,0,0,r),t}if(e){if(typeof ArrayBuffer<"u"&&e.buffer instanceof ArrayBuffer||"length"in e)return typeof e.length!="number"||lt(e.length)?Y(t,0):xe(t,e);if(e.type==="Buffer"&&er(e.data))return xe(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function Ke(t){if(t>=pe())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+pe().toString(16)+" bytes");return t|0}c.isBuffer=ft;function q(t){return!!(t!=null&&t._isBuffer)}c.compare=function(e,r){if(!q(e)||!q(r))throw new TypeError("Arguments must be Buffers");if(e===r)return 0;for(var i=e.length,n=r.length,o=0,s=Math.min(i,n);o<s;++o)if(e[o]!==r[o]){i=e[o],n=r[o];break}return i<n?-1:n<i?1:0};c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};c.concat=function(e,r){if(!er(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return c.alloc(0);var i;if(r===void 0)for(r=0,i=0;i<e.length;++i)r+=e[i].length;var n=c.allocUnsafe(r),o=0;for(i=0;i<e.length;++i){var s=e[i];if(!q(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,o),o+=s.length}return n};function ir(t,e){if(q(t))return t.length;if(typeof ArrayBuffer<"u"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;typeof t!="string"&&(t=""+t);var r=t.length;if(r===0)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return ve(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return r*2;case"hex":return r>>>1;case"base64":return hr(t).length;default:if(i)return ve(t).length;e=(""+e).toLowerCase(),i=!0}}c.byteLength=ir;function Gr(t,e,r){var i=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((r===void 0||r>this.length)&&(r=this.length),r<=0)||(r>>>=0,e>>>=0,r<=e))return"";for(t||(t="utf8");;)switch(t){case"hex":return nt(this,e,r);case"utf8":case"utf-8":return sr(this,e,r);case"ascii":return tt(this,e,r);case"latin1":case"binary":return it(this,e,r);case"base64":return et(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ot(this,e,r);default:if(i)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),i=!0}}c.prototype._isBuffer=!0;function Z(t,e,r){var i=t[e];t[e]=t[r],t[r]=i}c.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var r=0;r<e;r+=2)Z(this,r,r+1);return this};c.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var r=0;r<e;r+=4)Z(this,r,r+3),Z(this,r+1,r+2);return this};c.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var r=0;r<e;r+=8)Z(this,r,r+7),Z(this,r+1,r+6),Z(this,r+2,r+5),Z(this,r+3,r+4);return this};c.prototype.toString=function(){var e=this.length|0;return e===0?"":arguments.length===0?sr(this,0,e):Gr.apply(this,arguments)};c.prototype.equals=function(e){if(!q(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:c.compare(this,e)===0};c.prototype.inspect=function(){var e="",r=qr;return this.length>0&&(e=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(e+=" ... ")),"<Buffer "+e+">"};c.prototype.compare=function(e,r,i,n,o){if(!q(e))throw new TypeError("Argument must be a Buffer");if(r===void 0&&(r=0),i===void 0&&(i=e?e.length:0),n===void 0&&(n=0),o===void 0&&(o=this.length),r<0||i>e.length||n<0||o>this.length)throw new RangeError("out of range index");if(n>=o&&r>=i)return 0;if(n>=o)return-1;if(r>=i)return 1;if(r>>>=0,i>>>=0,n>>>=0,o>>>=0,this===e)return 0;for(var s=o-n,a=i-r,u=Math.min(s,a),h=this.slice(n,o),d=e.slice(r,i),p=0;p<u;++p)if(h[p]!==d[p]){s=h[p],a=d[p];break}return s<a?-1:a<s?1:0};function nr(t,e,r,i,n){if(t.length===0)return-1;if(typeof r=="string"?(i=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=n?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(n)return-1;r=t.length-1}else if(r<0)if(n)r=0;else return-1;if(typeof e=="string"&&(e=c.from(e,i)),q(e))return e.length===0?-1:Ge(t,e,r,i,n);if(typeof e=="number")return e=e&255,c.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?n?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):Ge(t,[e],r,i,n);throw new TypeError("val must be string, number or Buffer")}function Ge(t,e,r,i,n){var o=1,s=t.length,a=e.length;if(i!==void 0&&(i=String(i).toLowerCase(),i==="ucs2"||i==="ucs-2"||i==="utf16le"||i==="utf-16le")){if(t.length<2||e.length<2)return-1;o=2,s/=2,a/=2,r/=2}function u(l,v){return o===1?l[v]:l.readUInt16BE(v*o)}var h;if(n){var d=-1;for(h=r;h<s;h++)if(u(t,h)===u(e,d===-1?0:h-d)){if(d===-1&&(d=h),h-d+1===a)return d*o}else d!==-1&&(h-=h-d),d=-1}else for(r+a>s&&(r=s-a),h=r;h>=0;h--){for(var p=!0,f=0;f<a;f++)if(u(t,h+f)!==u(e,f)){p=!1;break}if(p)return h}return-1}c.prototype.includes=function(e,r,i){return this.indexOf(e,r,i)!==-1};c.prototype.indexOf=function(e,r,i){return nr(this,e,r,i,!0)};c.prototype.lastIndexOf=function(e,r,i){return nr(this,e,r,i,!1)};function Hr(t,e,r,i){r=Number(r)||0;var n=t.length-r;i?(i=Number(i),i>n&&(i=n)):i=n;var o=e.length;if(o%2!==0)throw new TypeError("Invalid hex string");i>o/2&&(i=o/2);for(var s=0;s<i;++s){var a=parseInt(e.substr(s*2,2),16);if(isNaN(a))return s;t[r+s]=a}return s}function Wr(t,e,r,i){return Se(ve(e,t.length-r),t,r,i)}function or(t,e,r,i){return Se(ht(e),t,r,i)}function Xr(t,e,r,i){return or(t,e,r,i)}function Zr(t,e,r,i){return Se(hr(e),t,r,i)}function Qr(t,e,r,i){return Se(dt(e,t.length-r),t,r,i)}c.prototype.write=function(e,r,i,n){if(r===void 0)n="utf8",i=this.length,r=0;else if(i===void 0&&typeof r=="string")n=r,i=this.length,r=0;else if(isFinite(r))r=r|0,isFinite(i)?(i=i|0,n===void 0&&(n="utf8")):(n=i,i=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var o=this.length-r;if((i===void 0||i>o)&&(i=o),e.length>0&&(i<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var s=!1;;)switch(n){case"hex":return Hr(this,e,r,i);case"utf8":case"utf-8":return Wr(this,e,r,i);case"ascii":return or(this,e,r,i);case"latin1":case"binary":return Xr(this,e,r,i);case"base64":return Zr(this,e,r,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Qr(this,e,r,i);default:if(s)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),s=!0}};c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function et(t,e,r){return e===0&&r===t.length?Je(t):Je(t.slice(e,r))}function sr(t,e,r){r=Math.min(t.length,r);for(var i=[],n=e;n<r;){var o=t[n],s=null,a=o>239?4:o>223?3:o>191?2:1;if(n+a<=r){var u,h,d,p;switch(a){case 1:o<128&&(s=o);break;case 2:u=t[n+1],(u&192)===128&&(p=(o&31)<<6|u&63,p>127&&(s=p));break;case 3:u=t[n+1],h=t[n+2],(u&192)===128&&(h&192)===128&&(p=(o&15)<<12|(u&63)<<6|h&63,p>2047&&(p<55296||p>57343)&&(s=p));break;case 4:u=t[n+1],h=t[n+2],d=t[n+3],(u&192)===128&&(h&192)===128&&(d&192)===128&&(p=(o&15)<<18|(u&63)<<12|(h&63)<<6|d&63,p>65535&&p<1114112&&(s=p))}}s===null?(s=65533,a=1):s>65535&&(s-=65536,i.push(s>>>10&1023|55296),s=56320|s&1023),i.push(s),n+=a}return rt(i)}var He=4096;function rt(t){var e=t.length;if(e<=He)return String.fromCharCode.apply(String,t);for(var r="",i=0;i<e;)r+=String.fromCharCode.apply(String,t.slice(i,i+=He));return r}function tt(t,e,r){var i="";r=Math.min(t.length,r);for(var n=e;n<r;++n)i+=String.fromCharCode(t[n]&127);return i}function it(t,e,r){var i="";r=Math.min(t.length,r);for(var n=e;n<r;++n)i+=String.fromCharCode(t[n]);return i}function nt(t,e,r){var i=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>i)&&(r=i);for(var n="",o=e;o<r;++o)n+=ct(t[o]);return n}function ot(t,e,r){for(var i=t.slice(e,r),n="",o=0;o<i.length;o+=2)n+=String.fromCharCode(i[o]+i[o+1]*256);return n}c.prototype.slice=function(e,r){var i=this.length;e=~~e,r=r===void 0?i:~~r,e<0?(e+=i,e<0&&(e=0)):e>i&&(e=i),r<0?(r+=i,r<0&&(r=0)):r>i&&(r=i),r<e&&(r=e);var n;if(c.TYPED_ARRAY_SUPPORT)n=this.subarray(e,r),n.__proto__=c.prototype;else{var o=r-e;n=new c(o,void 0);for(var s=0;s<o;++s)n[s]=this[s+e]}return n};function A(t,e,r){if(t%1!==0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}c.prototype.readUIntLE=function(e,r,i){e=e|0,r=r|0,i||A(e,r,this.length);for(var n=this[e],o=1,s=0;++s<r&&(o*=256);)n+=this[e+s]*o;return n};c.prototype.readUIntBE=function(e,r,i){e=e|0,r=r|0,i||A(e,r,this.length);for(var n=this[e+--r],o=1;r>0&&(o*=256);)n+=this[e+--r]*o;return n};c.prototype.readUInt8=function(e,r){return r||A(e,1,this.length),this[e]};c.prototype.readUInt16LE=function(e,r){return r||A(e,2,this.length),this[e]|this[e+1]<<8};c.prototype.readUInt16BE=function(e,r){return r||A(e,2,this.length),this[e]<<8|this[e+1]};c.prototype.readUInt32LE=function(e,r){return r||A(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};c.prototype.readUInt32BE=function(e,r){return r||A(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};c.prototype.readIntLE=function(e,r,i){e=e|0,r=r|0,i||A(e,r,this.length);for(var n=this[e],o=1,s=0;++s<r&&(o*=256);)n+=this[e+s]*o;return o*=128,n>=o&&(n-=Math.pow(2,8*r)),n};c.prototype.readIntBE=function(e,r,i){e=e|0,r=r|0,i||A(e,r,this.length);for(var n=r,o=1,s=this[e+--n];n>0&&(o*=256);)s+=this[e+--n]*o;return o*=128,s>=o&&(s-=Math.pow(2,8*r)),s};c.prototype.readInt8=function(e,r){return r||A(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]};c.prototype.readInt16LE=function(e,r){r||A(e,2,this.length);var i=this[e]|this[e+1]<<8;return i&32768?i|4294901760:i};c.prototype.readInt16BE=function(e,r){r||A(e,2,this.length);var i=this[e+1]|this[e]<<8;return i&32768?i|4294901760:i};c.prototype.readInt32LE=function(e,r){return r||A(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};c.prototype.readInt32BE=function(e,r){return r||A(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};c.prototype.readFloatLE=function(e,r){return r||A(e,4,this.length),Ee(this,e,!0,23,4)};c.prototype.readFloatBE=function(e,r){return r||A(e,4,this.length),Ee(this,e,!1,23,4)};c.prototype.readDoubleLE=function(e,r){return r||A(e,8,this.length),Ee(this,e,!0,52,8)};c.prototype.readDoubleBE=function(e,r){return r||A(e,8,this.length),Ee(this,e,!1,52,8)};function O(t,e,r,i,n,o){if(!q(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>n||e<o)throw new RangeError('"value" argument is out of bounds');if(r+i>t.length)throw new RangeError("Index out of range")}c.prototype.writeUIntLE=function(e,r,i,n){if(e=+e,r=r|0,i=i|0,!n){var o=Math.pow(2,8*i)-1;O(this,e,r,i,o,0)}var s=1,a=0;for(this[r]=e&255;++a<i&&(s*=256);)this[r+a]=e/s&255;return r+i};c.prototype.writeUIntBE=function(e,r,i,n){if(e=+e,r=r|0,i=i|0,!n){var o=Math.pow(2,8*i)-1;O(this,e,r,i,o,0)}var s=i-1,a=1;for(this[r+s]=e&255;--s>=0&&(a*=256);)this[r+s]=e/a&255;return r+i};c.prototype.writeUInt8=function(e,r,i){return e=+e,r=r|0,i||O(this,e,r,1,255,0),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[r]=e&255,r+1};function _e(t,e,r,i){e<0&&(e=65535+e+1);for(var n=0,o=Math.min(t.length-r,2);n<o;++n)t[r+n]=(e&255<<8*(i?n:1-n))>>>(i?n:1-n)*8}c.prototype.writeUInt16LE=function(e,r,i){return e=+e,r=r|0,i||O(this,e,r,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[r]=e&255,this[r+1]=e>>>8):_e(this,e,r,!0),r+2};c.prototype.writeUInt16BE=function(e,r,i){return e=+e,r=r|0,i||O(this,e,r,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[r]=e>>>8,this[r+1]=e&255):_e(this,e,r,!1),r+2};function ye(t,e,r,i){e<0&&(e=4294967295+e+1);for(var n=0,o=Math.min(t.length-r,4);n<o;++n)t[r+n]=e>>>(i?n:3-n)*8&255}c.prototype.writeUInt32LE=function(e,r,i){return e=+e,r=r|0,i||O(this,e,r,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[r+3]=e>>>24,this[r+2]=e>>>16,this[r+1]=e>>>8,this[r]=e&255):ye(this,e,r,!0),r+4};c.prototype.writeUInt32BE=function(e,r,i){return e=+e,r=r|0,i||O(this,e,r,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255):ye(this,e,r,!1),r+4};c.prototype.writeIntLE=function(e,r,i,n){if(e=+e,r=r|0,!n){var o=Math.pow(2,8*i-1);O(this,e,r,i,o-1,-o)}var s=0,a=1,u=0;for(this[r]=e&255;++s<i&&(a*=256);)e<0&&u===0&&this[r+s-1]!==0&&(u=1),this[r+s]=(e/a>>0)-u&255;return r+i};c.prototype.writeIntBE=function(e,r,i,n){if(e=+e,r=r|0,!n){var o=Math.pow(2,8*i-1);O(this,e,r,i,o-1,-o)}var s=i-1,a=1,u=0;for(this[r+s]=e&255;--s>=0&&(a*=256);)e<0&&u===0&&this[r+s+1]!==0&&(u=1),this[r+s]=(e/a>>0)-u&255;return r+i};c.prototype.writeInt8=function(e,r,i){return e=+e,r=r|0,i||O(this,e,r,1,127,-128),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[r]=e&255,r+1};c.prototype.writeInt16LE=function(e,r,i){return e=+e,r=r|0,i||O(this,e,r,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[r]=e&255,this[r+1]=e>>>8):_e(this,e,r,!0),r+2};c.prototype.writeInt16BE=function(e,r,i){return e=+e,r=r|0,i||O(this,e,r,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[r]=e>>>8,this[r+1]=e&255):_e(this,e,r,!1),r+2};c.prototype.writeInt32LE=function(e,r,i){return e=+e,r=r|0,i||O(this,e,r,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[r]=e&255,this[r+1]=e>>>8,this[r+2]=e>>>16,this[r+3]=e>>>24):ye(this,e,r,!0),r+4};c.prototype.writeInt32BE=function(e,r,i){return e=+e,r=r|0,i||O(this,e,r,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),c.TYPED_ARRAY_SUPPORT?(this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255):ye(this,e,r,!1),r+4};function ar(t,e,r,i,n,o){if(r+i>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function ur(t,e,r,i,n){return n||ar(t,e,r,4),Qe(t,e,r,i,23,4),r+4}c.prototype.writeFloatLE=function(e,r,i){return ur(this,e,r,!0,i)};c.prototype.writeFloatBE=function(e,r,i){return ur(this,e,r,!1,i)};function cr(t,e,r,i,n){return n||ar(t,e,r,8),Qe(t,e,r,i,52,8),r+8}c.prototype.writeDoubleLE=function(e,r,i){return cr(this,e,r,!0,i)};c.prototype.writeDoubleBE=function(e,r,i){return cr(this,e,r,!1,i)};c.prototype.copy=function(e,r,i,n){if(i||(i=0),!n&&n!==0&&(n=this.length),r>=e.length&&(r=e.length),r||(r=0),n>0&&n<i&&(n=i),n===i||e.length===0||this.length===0)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-r<n-i&&(n=e.length-r+i);var o=n-i,s;if(this===e&&i<r&&r<n)for(s=o-1;s>=0;--s)e[s+r]=this[s+i];else if(o<1e3||!c.TYPED_ARRAY_SUPPORT)for(s=0;s<o;++s)e[s+r]=this[s+i];else Uint8Array.prototype.set.call(e,this.subarray(i,i+o),r);return o};c.prototype.fill=function(e,r,i,n){if(typeof e=="string"){if(typeof r=="string"?(n=r,r=0,i=this.length):typeof i=="string"&&(n=i,i=this.length),e.length===1){var o=e.charCodeAt(0);o<256&&(e=o)}if(n!==void 0&&typeof n!="string")throw new TypeError("encoding must be a string");if(typeof n=="string"&&!c.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else typeof e=="number"&&(e=e&255);if(r<0||this.length<r||this.length<i)throw new RangeError("Out of range index");if(i<=r)return this;r=r>>>0,i=i===void 0?this.length:i>>>0,e||(e=0);var s;if(typeof e=="number")for(s=r;s<i;++s)this[s]=e;else{var a=q(e)?e:ve(new c(e,n).toString()),u=a.length;for(s=0;s<i-r;++s)this[s+r]=a[s%u]}return this};var st=/[^+\/0-9A-Za-z-_]/g;function at(t){if(t=ut(t).replace(st,""),t.length<2)return"";for(;t.length%4!==0;)t=t+"=";return t}function ut(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function ct(t){return t<16?"0"+t.toString(16):t.toString(16)}function ve(t,e){e=e||1/0;for(var r,i=t.length,n=null,o=[],s=0;s<i;++s){if(r=t.charCodeAt(s),r>55295&&r<57344){if(!n){if(r>56319){(e-=3)>-1&&o.push(239,191,189);continue}else if(s+1===i){(e-=3)>-1&&o.push(239,191,189);continue}n=r;continue}if(r<56320){(e-=3)>-1&&o.push(239,191,189),n=r;continue}r=(n-55296<<10|r-56320)+65536}else n&&(e-=3)>-1&&o.push(239,191,189);if(n=null,r<128){if((e-=1)<0)break;o.push(r)}else if(r<2048){if((e-=2)<0)break;o.push(r>>6|192,r&63|128)}else if(r<65536){if((e-=3)<0)break;o.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((e-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else throw new Error("Invalid code point")}return o}function ht(t){for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r)&255);return e}function dt(t,e){for(var r,i,n,o=[],s=0;s<t.length&&!((e-=2)<0);++s)r=t.charCodeAt(s),i=r>>8,n=r%256,o.push(n),o.push(i);return o}function hr(t){return Lr(at(t))}function Se(t,e,r,i){for(var n=0;n<i&&!(n+r>=e.length||n>=t.length);++n)e[n+r]=t[n];return n}function lt(t){return t!==t}function ft(t){return t!=null&&(!!t._isBuffer||dr(t)||pt(t))}function dr(t){return!!t.constructor&&typeof t.constructor.isBuffer=="function"&&t.constructor.isBuffer(t)}function pt(t){return typeof t.readFloatLE=="function"&&typeof t.slice=="function"&&dr(t.slice(0,0))}const Ie=t=>typeof t=="string"&&/^0x[0-9A-Fa-f]*$/.test(t),vt=t=>c.from(t,"utf8").toString("hex"),lr=t=>!t||typeof t!="object"||!("from"in t)?{isValid:!1,invalidMsg:se.INVALID_TRANSACTION}:t.value&&!Ie(t.value)?{isValid:!1,invalidMsg:se.INVALID_TRANSACTION_VALUE}:{isValid:!0},mt=t=>{if(!Array.isArray(t))return{isValid:!1,invalidMsg:se.INVALID_TRANSACTIONS};for(let e=0;e<t.length;e++){const{isValid:r,invalidMsg:i}=lr(t[e]);if(!r)return{isValid:r,invalidMsg:i}}return{isValid:!0}};function Re(){return g(this,void 0,void 0,function*(){const{networks:t}=yield fetch("https://api.blocto.app/networks/evm").then(r=>r.json());return t.reduce((r,i)=>Object.assign(Object.assign({},r),{[i.chain_id]:i}),{})})}var m={};function fr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function N(t){"@babel/helpers - typeof";return N=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},N(t)}function gt(t,e){if(N(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(N(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function wt(t){var e=gt(t,"string");return N(e)==="symbol"?e:String(e)}function Et(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,wt(i.key),i)}}function pr(t,e,r){return e&&Et(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function ae(t,e){return ae=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,n){return i.__proto__=n,i},ae(t,e)}function vr(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ae(t,e)}function _t(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function yt(t,e){if(e&&(N(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _t(t)}function ue(t){return ue=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ue(t)}function St(t){return Function.toString.call(t).indexOf("[native code]")!==-1}function bt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fe(t,e,r){return bt()?fe=Reflect.construct.bind():fe=function(n,o,s){var a=[null];a.push.apply(a,o);var u=Function.bind.apply(n,a),h=new u;return s&&ae(h,s.prototype),h},fe.apply(null,arguments)}function Pe(t){var e=typeof Map=="function"?new Map:void 0;return Pe=function(i){if(i===null||!St(i))return i;if(typeof i!="function")throw new TypeError("Super expression must either be null or a function");if(typeof e<"u"){if(e.has(i))return e.get(i);e.set(i,n)}function n(){return fe(i,arguments,ue(this).constructor)}return n.prototype=Object.create(i.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),ae(n,i)},Pe(t)}var H={},At=ce;ce.default=ce;ce.stable=wr;ce.stableStringify=wr;var me="[...]",mr="[Circular]",ee=[],Q=[];function gr(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function ce(t,e,r,i){typeof i>"u"&&(i=gr()),Te(t,"",0,[],void 0,0,i);var n;try{Q.length===0?n=JSON.stringify(t,e,r):n=JSON.stringify(t,Er(e),r)}catch{return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;ee.length!==0;){var o=ee.pop();o.length===4?Object.defineProperty(o[0],o[1],o[3]):o[0][o[1]]=o[2]}}return n}function te(t,e,r,i){var n=Object.getOwnPropertyDescriptor(i,r);n.get!==void 0?n.configurable?(Object.defineProperty(i,r,{value:t}),ee.push([i,r,e,n])):Q.push([e,r,t]):(i[r]=t,ee.push([i,r,e]))}function Te(t,e,r,i,n,o,s){o+=1;var a;if(N(t)==="object"&&t!==null){for(a=0;a<i.length;a++)if(i[a]===t){te(mr,t,e,n);return}if(typeof s.depthLimit<"u"&&o>s.depthLimit){te(me,t,e,n);return}if(typeof s.edgesLimit<"u"&&r+1>s.edgesLimit){te(me,t,e,n);return}if(i.push(t),Array.isArray(t))for(a=0;a<t.length;a++)Te(t[a],a,a,i,t,o,s);else{var u=Object.keys(t);for(a=0;a<u.length;a++){var h=u[a];Te(t[h],h,a,i,t,o,s)}}i.pop()}}function xt(t,e){return t<e?-1:t>e?1:0}function wr(t,e,r,i){typeof i>"u"&&(i=gr());var n=Ce(t,"",0,[],void 0,0,i)||t,o;try{Q.length===0?o=JSON.stringify(n,e,r):o=JSON.stringify(n,Er(e),r)}catch{return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;ee.length!==0;){var s=ee.pop();s.length===4?Object.defineProperty(s[0],s[1],s[3]):s[0][s[1]]=s[2]}}return o}function Ce(t,e,r,i,n,o,s){o+=1;var a;if(N(t)==="object"&&t!==null){for(a=0;a<i.length;a++)if(i[a]===t){te(mr,t,e,n);return}try{if(typeof t.toJSON=="function")return}catch{return}if(typeof s.depthLimit<"u"&&o>s.depthLimit){te(me,t,e,n);return}if(typeof s.edgesLimit<"u"&&r+1>s.edgesLimit){te(me,t,e,n);return}if(i.push(t),Array.isArray(t))for(a=0;a<t.length;a++)Ce(t[a],a,a,i,t,o,s);else{var u={},h=Object.keys(t).sort(xt);for(a=0;a<h.length;a++){var d=h[a];Ce(t[d],d,a,i,t,o,s),u[d]=t[d]}if(typeof n<"u")ee.push([n,e,t]),n[e]=u;else return u}i.pop()}}function Er(t){return t=typeof t<"u"?t:function(e,r){return r},function(e,r){if(Q.length>0)for(var i=0;i<Q.length;i++){var n=Q[i];if(n[1]===e&&n[0]===r){r=n[2],Q.splice(i,1);break}}return t.call(this,e,r)}}function _r(t){var e=It();return function(){var i=ue(t),n;if(e){var o=ue(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return yt(this,n)}}function It(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}Object.defineProperty(H,"__esModule",{value:!0});H.EthereumProviderError=H.EthereumRpcError=void 0;var Rt=At,yr=(function(t){vr(r,t);var e=_r(r);function r(i,n,o){var s;if(fr(this,r),!Number.isInteger(i))throw new Error('"code" must be an integer.');if(!n||typeof n!="string")throw new Error('"message" must be a nonempty string.');return s=e.call(this,n),s.code=i,o!==void 0&&(s.data=o),s}return pr(r,[{key:"serialize",value:function(){var n={code:this.code,message:this.message};return this.data!==void 0&&(n.data=this.data),this.stack&&(n.stack=this.stack),n}},{key:"toString",value:function(){return Rt.default(this.serialize(),Ct,2)}}]),r})(Pe(Error));H.EthereumRpcError=yr;var Pt=(function(t){vr(r,t);var e=_r(r);function r(i,n,o){if(fr(this,r),!Tt(i))throw new Error('"code" must be an integer such that: 1000 <= code <= 4999');return e.call(this,i,n,o)}return pr(r)})(yr);H.EthereumProviderError=Pt;function Tt(t){return Number.isInteger(t)&&t>=1e3&&t<=4999}function Ct(t,e){if(e!=="[Circular]")return e}var Le={},W={};Object.defineProperty(W,"__esModule",{value:!0});W.errorValues=W.errorCodes=void 0;W.errorCodes={rpc:{invalidInput:-32e3,resourceNotFound:-32001,resourceUnavailable:-32002,transactionRejected:-32003,methodNotSupported:-32004,limitExceeded:-32005,parse:-32700,invalidRequest:-32600,methodNotFound:-32601,invalidParams:-32602,internal:-32603},provider:{userRejectedRequest:4001,unauthorized:4100,unsupportedMethod:4200,disconnected:4900,chainDisconnected:4901}};W.errorValues={"-32700":{standard:"JSON RPC 2.0",message:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."},"-32600":{standard:"JSON RPC 2.0",message:"The JSON sent is not a valid Request object."},"-32601":{standard:"JSON RPC 2.0",message:"The method does not exist / is not available."},"-32602":{standard:"JSON RPC 2.0",message:"Invalid method parameter(s)."},"-32603":{standard:"JSON RPC 2.0",message:"Internal JSON-RPC error."},"-32000":{standard:"EIP-1474",message:"Invalid input."},"-32001":{standard:"EIP-1474",message:"Resource not found."},"-32002":{standard:"EIP-1474",message:"Resource unavailable."},"-32003":{standard:"EIP-1474",message:"Transaction rejected."},"-32004":{standard:"EIP-1474",message:"Method not supported."},"-32005":{standard:"EIP-1474",message:"Request limit exceeded."},4001:{standard:"EIP-1193",message:"User rejected the request."},4100:{standard:"EIP-1193",message:"The requested account and/or method has not been authorized by the user."},4200:{standard:"EIP-1193",message:"The requested method is not supported by this Ethereum provider."},4900:{standard:"EIP-1193",message:"The provider is disconnected from all chains."},4901:{standard:"EIP-1193",message:"The provider is disconnected from the specified chain."}};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.serializeError=t.isValidCode=t.getMessageFromCode=t.JSON_RPC_SERVER_ERROR_MESSAGE=void 0;var e=W,r=H,i=e.errorCodes.rpc.internal,n="Unspecified error message. This is a bug, please report it.",o={code:i,message:s(i)};t.JSON_RPC_SERVER_ERROR_MESSAGE="Unspecified server error.";function s(f){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:n;if(Number.isInteger(f)){var v=f.toString();if(p(e.errorValues,v))return e.errorValues[v].message;if(h(f))return t.JSON_RPC_SERVER_ERROR_MESSAGE}return l}t.getMessageFromCode=s;function a(f){if(!Number.isInteger(f))return!1;var l=f.toString();return!!(e.errorValues[l]||h(f))}t.isValidCode=a;function u(f){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},v=l.fallbackError,w=v===void 0?o:v,_=l.shouldIncludeStack,x=_===void 0?!1:_,I,U;if(!w||!Number.isInteger(w.code)||typeof w.message!="string")throw new Error("Must provide fallback error with integer number code and string message.");if(f instanceof r.EthereumRpcError)return f.serialize();var S={};if(f&&N(f)==="object"&&!Array.isArray(f)&&p(f,"code")&&a(f.code)){var C=f;S.code=C.code,C.message&&typeof C.message=="string"?(S.message=C.message,p(C,"data")&&(S.data=C.data)):(S.message=s(S.code),S.data={originalError:d(f)})}else{S.code=w.code;var L=(I=f)===null||I===void 0?void 0:I.message;S.message=L&&typeof L=="string"?L:w.message,S.data={originalError:d(f)}}var j=(U=f)===null||U===void 0?void 0:U.stack;return x&&f&&j&&typeof j=="string"&&(S.stack=j),S}t.serializeError=u;function h(f){return f>=-32099&&f<=-32e3}function d(f){return f&&N(f)==="object"&&!Array.isArray(f)?Object.assign({},f):f}function p(f,l){return Object.prototype.hasOwnProperty.call(f,l)}})(Le);function Ot(t){if(Array.isArray(t))return t}function Ft(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var i,n,o,s,a=[],u=!0,h=!1;try{if(o=(r=r.call(t)).next,e!==0)for(;!(u=(i=o.call(r)).done)&&(a.push(i.value),a.length!==e);u=!0);}catch(d){h=!0,n=d}finally{try{if(!u&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(h)throw n}}return a}}function We(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}function Nt(t,e){if(t){if(typeof t=="string")return We(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return We(t,e)}}function Dt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Sr(t,e){return Ot(t)||Ft(t,e)||Nt(t,e)||Dt()}var be={};Object.defineProperty(be,"__esModule",{value:!0});be.ethErrors=void 0;var je=H,br=Le,R=W;be.ethErrors={rpc:{parse:function(e){return M(R.errorCodes.rpc.parse,e)},invalidRequest:function(e){return M(R.errorCodes.rpc.invalidRequest,e)},invalidParams:function(e){return M(R.errorCodes.rpc.invalidParams,e)},methodNotFound:function(e){return M(R.errorCodes.rpc.methodNotFound,e)},internal:function(e){return M(R.errorCodes.rpc.internal,e)},server:function(e){if(!e||N(e)!=="object"||Array.isArray(e))throw new Error("Ethereum RPC Server errors must provide single object argument.");var r=e.code;if(!Number.isInteger(r)||r>-32005||r<-32099)throw new Error('"code" must be an integer such that: -32099 <= code <= -32005');return M(r,e)},invalidInput:function(e){return M(R.errorCodes.rpc.invalidInput,e)},resourceNotFound:function(e){return M(R.errorCodes.rpc.resourceNotFound,e)},resourceUnavailable:function(e){return M(R.errorCodes.rpc.resourceUnavailable,e)},transactionRejected:function(e){return M(R.errorCodes.rpc.transactionRejected,e)},methodNotSupported:function(e){return M(R.errorCodes.rpc.methodNotSupported,e)},limitExceeded:function(e){return M(R.errorCodes.rpc.limitExceeded,e)}},provider:{userRejectedRequest:function(e){return oe(R.errorCodes.provider.userRejectedRequest,e)},unauthorized:function(e){return oe(R.errorCodes.provider.unauthorized,e)},unsupportedMethod:function(e){return oe(R.errorCodes.provider.unsupportedMethod,e)},disconnected:function(e){return oe(R.errorCodes.provider.disconnected,e)},chainDisconnected:function(e){return oe(R.errorCodes.provider.chainDisconnected,e)},custom:function(e){if(!e||N(e)!=="object"||Array.isArray(e))throw new Error("Ethereum Provider custom errors must provide single object argument.");var r=e.code,i=e.message,n=e.data;if(!i||typeof i!="string")throw new Error('"message" must be a nonempty string');return new je.EthereumProviderError(r,i,n)}}};function M(t,e){var r=Ar(e),i=Sr(r,2),n=i[0],o=i[1];return new je.EthereumRpcError(t,n||br.getMessageFromCode(t),o)}function oe(t,e){var r=Ar(e),i=Sr(r,2),n=i[0],o=i[1];return new je.EthereumProviderError(t,n||br.getMessageFromCode(t),o)}function Ar(t){if(t){if(typeof t=="string")return[t];if(N(t)==="object"&&!Array.isArray(t)){var e=t.message,r=t.data;if(e&&typeof e!="string")throw new Error("Must specify string message.");return[e||void 0,r]}}return[]}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.getMessageFromCode=t.serializeError=t.EthereumProviderError=t.EthereumRpcError=t.ethErrors=t.errorCodes=void 0;var e=H;Object.defineProperty(t,"EthereumRpcError",{enumerable:!0,get:function(){return e.EthereumRpcError}}),Object.defineProperty(t,"EthereumProviderError",{enumerable:!0,get:function(){return e.EthereumProviderError}});var r=Le;Object.defineProperty(t,"serializeError",{enumerable:!0,get:function(){return r.serializeError}}),Object.defineProperty(t,"getMessageFromCode",{enumerable:!0,get:function(){return r.getMessageFromCode}});var i=be;Object.defineProperty(t,"ethErrors",{enumerable:!0,get:function(){return i.ethErrors}});var n=W;Object.defineProperty(t,"errorCodes",{enumerable:!0,get:function(){return n.errorCodes}})})(m);var E,T,xr,z,Oe;function P(t){return t?typeof t=="number"?t:t.startsWith("0x")?parseInt(t,16):parseInt(t,10):1}class Mt extends Xe{get existedSDK(){if(!(typeof window>"u"))return window.ethereum}constructor(e){var r;if(super(),E.add(this),this.networkVersion="1",this.off=this.removeListener,this.injectedWalletServer=e.walletServer,this._blocto={sessionKeyEnv:K.prod,walletServer:this.injectedWalletServer||"",blockchainName:"",networkType:"",switchableNetwork:{}},this.appId=e.appId||Fe,"chainId"in e){const{chainId:i,rpc:n}=e;re(i,"'chainId' is required"),this.networkVersion=`${P(i)}`,this.chainId=`0x${P(i).toString(16)}`,this.rpc=n||Ae[this.networkVersion],re(this.rpc,"'rpc' is required")}else{const{defaultChainId:i,switchableChains:n}=e;re(i,"'defaultChainId' is required"),this.networkVersion=`${P(i)}`,this.chainId=`0x${P(i).toString(16)}`;const o=n.find(s=>P(s.chainId)===P(i));if(!o)throw m.ethErrors.provider.custom({code:1001,message:`Chain ${i} is not in switchableChains list`});this.rpc=((r=o.rpcUrls)===null||r===void 0?void 0:r[0])||Ae[this.networkVersion],re(this.rpc,"'rpc' is required"),this._blocto.unloadedNetwork=n}}send(e,r){return g(this,void 0,void 0,function*(){switch(!0){case r instanceof Function:return this.sendAsync(e,r);case(typeof e=="string"&&Array.isArray(r)):return this.sendAsync({jsonrpc:"2.0",method:e,params:r});default:return this.sendAsync(e)}})}sendAsync(e,r){return g(this,void 0,void 0,function*(){const i=a=>a.reduce((u,h)=>{var d;return h.method==="eth_sendTransaction"?u.sendRequests.push((d=h.params)===null||d===void 0?void 0:d[0]):u.otherRequests.push(this.request(h)),u},{sendRequests:[],otherRequests:[]});function n(a){return{id:String(a.id),jsonrpc:"2.0",method:a.method}}function o(a,u){const h=[];let d=1;return a.forEach(p=>{const f=n(p);p.method==="eth_sendTransaction"?(f.result=u[0].value,f.error=u[0].status!=="fulfilled"?u[0].reason:void 0):d<u.length&&(f.result=u[d].value,f.error=u[d].status!=="fulfilled"?u[d].reason:void 0,d++),h.push(f)}),h}const s=new Promise(a=>{if(Array.isArray(e)){const{sendRequests:u,otherRequests:h}=i(e),d={method:"wallet_sendMultiCallTransaction",params:[u,!1]},p=u.length===0,f=Math.floor(Math.random()*1e4),l=p?[...h]:[this.request(d),...h];Promise.allSettled(l).then(v=>{if(p)return a(v.map((_,x)=>{var I;return{id:String(((I=e[x])===null||I===void 0?void 0:I.id)||f+x+1),jsonrpc:"2.0",method:e[x].method,result:_.status==="fulfilled"?_.value:void 0,error:_.status!=="fulfilled"?_.reason:void 0}}));const w=o(e,v);return a(w)}).catch(v=>{throw m.ethErrors.rpc.internal(v?.message)})}else this.request(Object.assign(Object.assign({},e),{id:Number(e.id)})).then(a)});if(typeof r=="function")s.then(a=>r(null,a)).catch(a=>r(a));else return s})}sendUserOperation(e){return g(this,void 0,void 0,function*(){return this.request({method:"eth_sendUserOperation",params:[e]})})}request(e){var r,i,n,o,s,a,u,h;return g(this,void 0,void 0,function*(){if(Array.isArray(e))return this.sendAsync(e);if(!e?.method)throw m.ethErrors.rpc.invalidRequest();const{blockchainName:d,switchableNetwork:p,sessionKeyEnv:f}=yield y(this,E,"m",T).call(this);if(!((r=this.existedSDK)===null||r===void 0)&&r.isBlocto){if(e.method==="wallet_switchEthereumChain"){if(!(!((n=(i=e?.params)===null||i===void 0?void 0:i[0])===null||n===void 0)&&n.chainId))throw m.ethErrors.rpc.invalidParams();return this.existedSDK.request(e).then(()=>{var l,v,w;return this.networkVersion=`${P((l=e?.params)===null||l===void 0?void 0:l[0].chainId)}`,this.chainId=`0x${P((v=e?.params)===null||v===void 0?void 0:v[0].chainId).toString(16)}`,this.rpc=(w=p?.[this.networkVersion])===null||w===void 0?void 0:w.rpc_url,null})}return this.existedSDK.request(e)}switch(e.method){case"eth_chainId":return this.chainId;case"net_version":return this.networkVersion;case"wallet_addEthereumChain":return this.loadSwitchableNetwork(e?.params||[]);case"eth_blockNumber":case"web3_clientVersion":case"eth_call":{const l=yield this.handleReadRequests(e);if(!l||l&&!l.result&&l.error){const v=!((o=l?.error)===null||o===void 0)&&o.message?l.error.message:"Request failed";throw m.ethErrors.rpc.internal(v)}return typeof e?.callback=="function"&&e.callback(null,l.result),l.result}case"wallet_switchEthereumChain":return this.handleSwitchChain((a=(s=e?.params)===null||s===void 0?void 0:s[0])===null||a===void 0?void 0:a.chainId);case"wallet_disconnect":return this.handleDisconnect();case"eth_accounts":return ne(f,d)||[]}if(!ne(f,d)){const l=(u=e?.params)===null||u===void 0?void 0:u[0];e.method==="eth_requestAccounts"&&Ye(l)?yield this.enable(l):yield this.enable()}try{let l=null,v=null;switch(e.method){case"eth_requestAccounts":{v=yield this.fetchAccounts();break}case"eth_coinbase":{v=(h=ne(f,d))===null||h===void 0?void 0:h[0];break}case"eth_signTypedData_v3":case"eth_signTypedData":case"eth_signTypedData_v4":case"personal_sign":{v=yield this.handleSign(e);break}case"eth_sign":throw m.ethErrors.rpc.methodNotFound("Method Not Supported: eth_sign has been disabled");case"eth_sendTransaction":v=yield this.handleSendTransaction(e);break;case"wallet_sendMultiCallTransaction":v=yield this.handleSendBatchTransaction(e);break;case"eth_signTransaction":case"eth_sendRawTransaction":throw m.ethErrors.rpc.methodNotSupported("Method Not Supported: "+e.method);case"eth_sendUserOperation":v=yield this.handleSendUserOperation(e);break;case"eth_estimateUserOperationGas":case"eth_getUserOperationByHash":case"eth_getUserOperationReceipt":case"eth_supportedEntryPoints":v=yield this.handleBundler(e);break;default:l=yield this.handleReadRequests(e)}if(l&&!l.result&&l.error){const w=l.error.message?l.error.message:"Request failed";throw m.ethErrors.rpc.internal(w)}return l?l.result:v}catch(l){throw m.ethErrors.rpc.internal(l?.message)}})}bloctoApi(e,r){var i;return g(this,void 0,void 0,function*(){const{walletServer:n,blockchainName:o,sessionKeyEnv:s}=yield y(this,E,"m",T).call(this),a=((i=G(s))===null||i===void 0?void 0:i.code)||"";if(!a)throw m.ethErrors.provider.unauthorized();return fetch(`${n}/api/${o}${e}`,Object.assign({headers:{"Content-Type":"application/json","Blocto-Application-Identifier":this.appId,"Blocto-Session-Identifier":a}},r)).then(u=>le(u,s,()=>{var h;(h=this.eventListeners)===null||h===void 0||h.disconnect.forEach(d=>d(m.ethErrors.provider.disconnected()))})).catch(u=>{throw u?.error_code==="unsupported_method"?m.ethErrors.rpc.methodNotSupported("Method Not Supported: "+u.message):m.ethErrors.rpc.server({code:-32005,message:`Blocto server error: ${u.message}`})})})}responseListener(e,r){return g(this,void 0,void 0,function*(){const{walletServer:i}=yield y(this,E,"m",T).call(this);return new Promise((n,o)=>J("message",(s,a)=>{const u=s;u.origin===i&&u.data.type==="ETH:FRAME:RESPONSE"&&(u.data.status==="APPROVED"&&(a(),F(e),n(u.data[r])),u.data.status==="DECLINED"&&(a(),F(e),u.data.errorCode==="incorrect_session_id"&&this.handleDisconnect(),o(m.ethErrors.provider.userRejectedRequest(u.data.errorMessage)))),u.data.type==="ETH:FRAME:CLOSE"&&(a(),F(e),o(m.ethErrors.provider.userRejectedRequest("User declined the request")))}))})}setIframe(e,r){return g(this,void 0,void 0,function*(){if(typeof window>"u")throw m.ethErrors.provider.custom({code:1001,message:"Blocto SDK only works in browser environment"});const{walletServer:i,blockchainName:n}=yield y(this,E,"m",T).call(this),o=he(`${i}/${this.appId}/${r||n}${e}`);return de(o),o})}enable(e){var r;return g(this,void 0,void 0,function*(){if(typeof window>"u")throw m.ethErrors.provider.custom({code:1001,message:"Blocto SDK only works in browser environment"});const{walletServer:i,blockchainName:n,sessionKeyEnv:o}=yield y(this,E,"m",T).call(this);if(!((r=this.existedSDK)===null||r===void 0)&&r.isBlocto)return this.existedSDK.chainId!==this.chainId&&(yield this.existedSDK.request({method:"wallet_addEthereumChain",params:[{chainId:this.chainId}]}),yield this.existedSDK.request({method:"wallet_switchEthereumChain",params:[{chainId:this.chainId}]}),qe(o,n,[this.existedSDK.address])),new Promise((d,p)=>setTimeout(()=>this.existedSDK.enable().then(d).catch(p),10));const s=ne(o,n);if(s)return new Promise(d=>{d(s)});const a=new URLSearchParams;a.set("l6n",window.location.origin),a.set("v",ge),a.set("q",`${window.location.pathname}${window.location.search}`);const u=e&&Ye(e)?`/${e}`:"",h=yield this.setIframe(`/authn${u}?${a.toString()}`);return new Promise((d,p)=>{J("message",(f,l)=>{var v,w;const _=f;_.origin===i&&(_.data.type==="ETH:FRAME:RESPONSE"&&(l(),F(h),(v=this.eventListeners)===null||v===void 0||v.connect.forEach(x=>x({chainId:this.chainId})),ie(o,{code:_.data.code,evm:{[n]:[_.data.addr]}},_.data.exp),!((w=_.data)===null||w===void 0)&&w.isAccountChanged&&postMessage({originChain:b.ETHEREUM,type:"BLOCTO_SDK:ACCOUNT_CHANGED"}),J("message",(x,I)=>{var U,S,C;const L=x,j=((U=L.data)===null||U===void 0?void 0:U.type)==="BLOCTO_SDK:ACCOUNT_CHANGED",D=((S=L.data)===null||S===void 0?void 0:S.originChain)!==b.ETHEREUM;j&&((C=this.eventListeners)===null||C===void 0||C.accountsChanged.forEach(V=>V([_.data.addr]))),j&&D&&(this.handleDisconnect(),I())}),d([_.data.addr])),_.data.type==="ETH:FRAME:CLOSE"&&(l(),F(h),p(m.ethErrors.provider.userRejectedRequest())))})})})}fetchAccounts(){return g(this,void 0,void 0,function*(){y(this,E,"m",z).call(this);const{blockchainName:e,sessionKeyEnv:r}=yield y(this,E,"m",T).call(this),{accounts:i}=yield this.bloctoApi("/accounts");return qe(r,e,i),i})}handleReadRequests(e){return g(this,void 0,void 0,function*(){return y(this,E,"m",z).call(this),fetch(this.rpc,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Object.assign({id:1,jsonrpc:"2.0"},e))}).then(r=>r.json()).catch(r=>{throw m.ethErrors.rpc.internal(r)})})}handleSign({method:e,params:r}){return g(this,void 0,void 0,function*(){let i="";if(Array.isArray(r)){if(e==="personal_sign")i=Ie(r[0])?r[0].slice(2):vt(r[0]);else if(["eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4"].includes(e)){i=r[1];const{domain:s}=JSON.parse(i);if(Ie(s.chainId))throw m.ethErrors.rpc.invalidParams(`Provided chainId "${s.chainId}" must be a number`);if(P(s.chainId)!==P(this.chainId))throw m.ethErrors.rpc.invalidParams(`Provided chainId "${s.chainId}" must match the active chainId "${P(this.chainId)}"`)}}y(this,E,"m",z).call(this);const{signatureId:n}=yield this.bloctoApi("/user-signature",{method:"POST",body:JSON.stringify({method:e,message:i})}),o=yield this.setIframe(`/user-signature/${n}`);return this.responseListener(o,"signature")})}handleSwitchChain(e){var r,i;return g(this,void 0,void 0,function*(){if(!e)throw m.ethErrors.rpc.invalidParams();const{walletServer:n,blockchainName:o,sessionKeyEnv:s,switchableNetwork:a}=yield y(this,E,"m",T).call(this),u=(r=ne(s,o))===null||r===void 0?void 0:r[0],h=P(this.chainId),d=P(e);if(h===d)return null;if(!a[d])throw m.ethErrors.provider.custom({code:4902,message:`Unrecognized chain ID "${d}". Try adding the chain using wallet_addEthereumChain first.`});if(this.networkVersion=`${d}`,this.chainId=`0x${d.toString(16)}`,this.rpc=a[d].rpc_url,this._blocto=Object.assign(Object.assign({},this._blocto),{blockchainName:"",networkType:""}),!u)return(i=this.eventListeners)===null||i===void 0||i.chainChanged.forEach(f=>f(this.chainId)),yield y(this,E,"m",T).call(this),null;if(a[d].wallet_web_url!==a[h].wallet_web_url)return this.enable().then(([f])=>{var l;return f!==u&&((l=this.eventListeners)===null||l===void 0||l.accountsChanged.forEach(v=>v([f]))),this.eventListeners.chainChanged.forEach(v=>v(this.chainId)),null}).catch(f=>{throw this.networkVersion=`${h}`,this.chainId=`0x${h.toString(16)}`,this.rpc=a[h].rpc_url,this._blocto=Object.assign(Object.assign({},this._blocto),{blockchainName:"",networkType:""}),y(this,E,"m",T).call(this),f});const p=yield this.setIframe(`/switch-chain?to=${a[d].name}`,a[h].name);return new Promise((f,l)=>{J("message",(v,w)=>{var _,x,I,U,S,C,L,j;const D=v;D.origin===n&&(D.data.type==="ETH:FRAME:RESPONSE"&&(w(),F(p),!((_=D.data)===null||_===void 0)&&_.addr&&u&&(ie(s,{code:(x=D.data)===null||x===void 0?void 0:x.code,evm:{[a[d].name]:[D.data.addr]}},(I=D.data)===null||I===void 0?void 0:I.exp),D.data.addr!==u&&((U=this.eventListeners)===null||U===void 0||U.accountsChanged.forEach(V=>V([D.data.addr])))),(S=this.eventListeners)===null||S===void 0||S.chainChanged.forEach(V=>V(this.chainId)),y(this,E,"m",T).call(this),f(null)),D.data.type==="ETH:FRAME:CLOSE"&&(w(),F(p),!((C=D.data)===null||C===void 0)&&C.hasApprovedSwitchChain?((L=this.eventListeners)===null||L===void 0||L.chainChanged.forEach(V=>V(this.chainId)),Ve(s),(j=this.eventListeners)===null||j===void 0||j.disconnect.forEach(V=>V(m.ethErrors.provider.disconnected())),y(this,E,"m",T).call(this),f(null)):(this.networkVersion=`${h}`,this.chainId=`0x${h.toString(16)}`,this.rpc=a[h].rpc_url,this._blocto=Object.assign(Object.assign({},this._blocto),{blockchainName:"",networkType:""}),y(this,E,"m",T).call(this),l(m.ethErrors.provider.userRejectedRequest()))))})})})}handleSendTransaction(e){var r;return g(this,void 0,void 0,function*(){y(this,E,"m",z).call(this);const{isValid:i,invalidMsg:n}=lr((r=e.params)===null||r===void 0?void 0:r[0]);if(!i)throw m.ethErrors.rpc.invalidParams(n);return y(this,E,"m",Oe).call(this,e.params)})}handleSendBatchTransaction(e){return g(this,void 0,void 0,function*(){y(this,E,"m",z).call(this);let r,i;Array.isArray(e.params)&&e.params.length>=2?[r,i]=e.params:(r=e.params,i=!1);const n=i||!1,{isValid:o,invalidMsg:s}=mt(r);if(!o)throw m.ethErrors.rpc.invalidParams(s);return y(this,E,"m",Oe).call(this,r,n)})}handleSendUserOperation(e){return g(this,void 0,void 0,function*(){y(this,E,"m",z).call(this);const{authorizationId:r}=yield this.bloctoApi("/user-operation",{method:"POST",body:JSON.stringify(e.params)}),i=yield this.setIframe(`/user-operation/${r}`);return this.responseListener(i,"userOpHash")})}handleBundler(e){return g(this,void 0,void 0,function*(){return y(this,E,"m",z).call(this),this.bloctoApi("/rpc/bundler",{method:"POST",body:JSON.stringify(Object.assign({id:1,jsonrpc:"2.0"},e))})})}handleDisconnect(){var e,r;return g(this,void 0,void 0,function*(){if(!((e=this.existedSDK)===null||e===void 0)&&e.isBlocto)return this.existedSDK.request({method:"wallet_disconnect"});const{sessionKeyEnv:i}=yield y(this,E,"m",T).call(this);Ve(i),(r=this.eventListeners)===null||r===void 0||r.disconnect.forEach(n=>n(m.ethErrors.provider.disconnected()))})}loadSwitchableNetwork(e){return g(this,void 0,void 0,function*(){if(e?.length){const r=e.map(({chainId:i,rpcUrls:n})=>{if(!i)throw m.ethErrors.rpc.invalidParams("Empty chainId");const o=`${P(i)}`;if(this._blocto.switchableNetwork[o])return null;const s=n?.[0]||Ae[o];if(!s)throw m.ethErrors.rpc.invalidParams("rpcUrls required");return y(this,E,"m",xr).call(this,{chainId:o,rpcUrls:[s]})});return Promise.all(r).then(()=>null)}else throw m.ethErrors.rpc.invalidParams("Empty networkList")})}supportChainList(){return g(this,void 0,void 0,function*(){const e=yield Re().catch(r=>{throw m.ethErrors.provider.custom({code:1001,message:`Get blocto server failed: ${r.message}`})});return Object.keys(e).map(r=>{const{display_name:i}=e[r];return{chainId:r,chainName:i}})})}on(e,r){var i;!((i=this.existedSDK)===null||i===void 0)&&i.isBlocto&&this.existedSDK.on(e,r),super.on(e,r)}removeListener(e,r){var i;!((i=this.existedSDK)===null||i===void 0)&&i.isBlocto&&this.existedSDK.off(e,r),super.removeListener(e,r)}}E=new WeakSet,T=function(){var e,r;return g(this,void 0,void 0,function*(){if(!((e=this._blocto)===null||e===void 0)&&e.unloadedNetwork&&(yield this.loadSwitchableNetwork(this._blocto.unloadedNetwork),delete this._blocto.unloadedNetwork),this._blocto.sessionKeyEnv&&this._blocto.walletServer&&this._blocto.blockchainName&&this._blocto.networkType&&this._blocto.switchableNetwork)return this._blocto;const i=yield Re().catch(d=>{throw m.ethErrors.provider.custom({code:1001,message:`Get blocto server failed: ${d.message}`})}),{chain_id:n,name:o,network_type:s,blocto_service_environment:a,display_name:u}=(r=i[this.networkVersion])!==null&&r!==void 0?r:{};if(!n)throw m.ethErrors.provider.unsupportedMethod(`Get support chain failed: ${this.networkVersion} might not be supported yet.`);const h=this.injectedWalletServer||ke[a];return this._blocto=Object.assign(Object.assign({},this._blocto),{sessionKeyEnv:Ir[a],walletServer:h,blockchainName:o,networkType:s,switchableNetwork:Object.assign(Object.assign({},this._blocto.switchableNetwork),{[n]:{name:o,display_name:u,network_type:s,wallet_web_url:h,rpc_url:this.rpc}})}),this._blocto})},xr=function({chainId:e,rpcUrls:r}){var i;return g(this,void 0,void 0,function*(){yield y(this,E,"m",T).call(this);const n=yield Re().catch(p=>{throw m.ethErrors.provider.custom({code:1001,message:`Get blocto server failed: ${p.message}`})}),{chain_id:o,name:s,display_name:a,network_type:u,blocto_service_environment:h}=(i=n[e])!==null&&i!==void 0?i:{};if(!o)throw m.ethErrors.provider.unsupportedMethod(`Get support chain failed: ${e} might not be supported yet.`);const d=ke[h];this._blocto.switchableNetwork[o]={name:s,display_name:a,network_type:u,wallet_web_url:d,rpc_url:r[0]}})},z=function(){var e;if(!((e=this.existedSDK)===null||e===void 0)&&e.isBlocto&&P(this.existedSDK.chainId)!==P(this.chainId))throw m.ethErrors.provider.chainDisconnected()},Oe=function(e,r=!0){return g(this,void 0,void 0,function*(){const{authorizationId:i}=yield this.bloctoApi("/authz",{method:"POST",body:JSON.stringify([e,r])}),n=new URLSearchParams;n.set("l6n",window.location.origin),n.set("q",`${window.location.pathname}${window.location.search}`);const o=yield this.setIframe(`/authz/${i}?${n.toString()}`);return this.responseListener(o,"txHash")})};const Bt=t=>{var e,r;const i=Object.assign({},t),{message:n,nonce:o,address:s,application:a,chainId:u}=t;return typeof n!="string"&&(i.message=(e=String(n))!==null&&e!==void 0?e:""),typeof o!="string"&&(i.nonce=(r=String(o))!==null&&r!==void 0?r:""),s&&typeof s!="boolean"&&(i.address=!!s),a&&typeof a!="boolean"&&(i.application=!!a),u&&typeof u!="boolean"&&(i.chainId=!!u),i};class Ut extends Xe{get existedSDK(){if(!(typeof window>"u"))return window.bloctoAptos}constructor({chainId:e,server:r,appId:i}){super(),this.publicKey=[],this.authKey="",this.off=this.removeListener,re(e,"'chainId' is required"),re(i,"It is necessary to interact with Blocto wallet via your app id. Please visit https://developers.blocto.app for more details."),this.chainId=e,this.networkName=Tr[e],this.api=Cr[e],this.sessionKey=Rr[e];const n=Pr[e];this.appId=i||Fe,this.server=r||n||""}get publicAccount(){var e;return{address:((e=k(this.sessionKey,b.APTOS))===null||e===void 0?void 0:e[0])||null,publicKey:this.publicKey.length?this.publicKey:null,authKey:null,minKeysRequired:2}}network(){return g(this,void 0,void 0,function*(){return{name:this.networkName,api:this.api,chainId:this.chainId.toString()}})}isConnected(){var e;return g(this,void 0,void 0,function*(){return!!(!((e=k(this.sessionKey,b.APTOS))===null||e===void 0)&&e.length)})}signTransaction(e){var r;return g(this,void 0,void 0,function*(){if(this.existedSDK)return this.existedSDK.signTransaction(e);throw(yield this.isConnected())||(yield this.connect()),!((r=k(this.sessionKey,b.APTOS))===null||r===void 0)&&r.length?new Error("signTransaction method not supported."):new Error("Fail to get account")})}disconnect(){var e;return g(this,void 0,void 0,function*(){if(this.existedSDK){yield this.existedSDK.disconnect();return}Ur(this.sessionKey,b.APTOS),(e=this.eventListeners)===null||e===void 0||e.disconnect.forEach(r=>r({code:4900,message:"Wallet disconnected"}))})}signAndSubmitTransaction(e,r={}){var i,n;return g(this,void 0,void 0,function*(){if(this.existedSDK)return this.existedSDK.signAndSubmitTransaction(e,r);if((yield this.isConnected())||(yield this.connect()),!(!((i=k(this.sessionKey,b.APTOS))===null||i===void 0)&&i.length))throw new Error("Fail to get account");const s=((n=G(this.sessionKey))===null||n===void 0?void 0:n.code)||"",{authorizationId:a}=yield fetch(`${this.server}/api/aptos/authz`,{method:"POST",headers:{"Content-Type":"application/json","Blocto-Application-Identifier":this.appId,"Blocto-Session-Identifier":s},body:JSON.stringify(Object.assign(Object.assign({},e),r))}).then(h=>le(h,this.sessionKey));if(typeof window>"u")throw new Error("Currently only supported in browser");const u=he(`${this.server}/${this.appId}/aptos/authz/${a}`);return de(u),new Promise((h,d)=>J("message",(p,f)=>{const l=p;l.origin===this.server&&l.data.type==="APTOS:FRAME:RESPONSE"&&(l.data.status==="APPROVED"&&(f(),F(u),h({hash:l.data.txHash})),l.data.status==="DECLINED"&&(f(),F(u),l.data.errorCode==="incorrect_session_id"&&this.disconnect(),d(new Error(l.data.errorMessage))))}))})}signMessage(e){var r,i;return g(this,void 0,void 0,function*(){const n=Bt(e);if(this.existedSDK)return this.existedSDK.signMessage(n);if((yield this.isConnected())||(yield this.connect()),!(!((r=k(this.sessionKey,b.APTOS))===null||r===void 0)&&r.length))throw new Error("Fail to get account");if(typeof window>"u")throw new Error("Currently only supported in browser");const s=((i=G(this.sessionKey))===null||i===void 0?void 0:i.code)||"",{signatureId:a}=yield fetch(`${this.server}/api/aptos/user-signature`,{method:"POST",headers:{"Content-Type":"application/json","Blocto-Application-Identifier":this.appId,"Blocto-Session-Identifier":s},body:JSON.stringify(n)}).then(d=>le(d,this.sessionKey)),u=`${this.server}/${this.appId}/aptos/user-signature/${a}`,h=he(u);return de(h),new Promise((d,p)=>J("message",(f,l)=>{const v=f;v.origin===this.server&&v.data.type==="APTOS:FRAME:RESPONSE"&&(v.data.status==="APPROVED"&&(l(),F(h),d(v.data)),v.data.status==="DECLINED"&&(l(),F(h),v.data.errorCode==="incorrect_session_id"&&this.disconnect(),p(new Error(v.data.errorMessage))))}))})}connect(){return g(this,void 0,void 0,function*(){return this.existedSDK?new Promise((e,r)=>setTimeout(()=>this.existedSDK.connect().then(e).catch(r),10)):new Promise((e,r)=>{var i,n;if(typeof window>"u")return r("Currently only supported in browser");if(!((i=k(this.sessionKey,b.APTOS))===null||i===void 0)&&i.length)return e({address:((n=k(this.sessionKey,b.APTOS))===null||n===void 0?void 0:n[0])||null,publicKey:this.publicKey,authKey:null,minKeysRequired:2});const o=encodeURIComponent(window.location.origin),s=he(`${this.server}/${this.appId}/aptos/authn?l6n=${o}&v=${ge}}`);de(s),J("message",(a,u)=>g(this,void 0,void 0,function*(){var h,d,p,f;const l=a;if(l.origin===this.server){if(l.data.type==="APTOS:FRAME:RESPONSE")if(u(),F(s),ie(this.sessionKey,{code:l.data.code,accounts:{[b.APTOS]:[l.data.addr]}},l.data.exp),!((h=l.data)===null||h===void 0)&&h.isAccountChanged&&postMessage({originChain:b.APTOS,type:"BLOCTO_SDK:ACCOUNT_CHANGED"}),J("message",(v,w)=>{var _,x;const I=v;((_=I.data)===null||_===void 0?void 0:_.type)==="BLOCTO_SDK:ACCOUNT_CHANGED"&&((x=I.data)===null||x===void 0?void 0:x.originChain)!==b.APTOS&&(this.disconnect(),w())}),!((d=k(this.sessionKey,b.APTOS))===null||d===void 0)&&d.length)try{const{public_keys:v}=yield fetch(`${this.server}/blocto/aptos/accounts/${(p=k(this.sessionKey,b.APTOS))===null||p===void 0?void 0:p[0]}`).then(w=>w.json());this.publicKey=v||[],e({address:((f=k(this.sessionKey,b.APTOS))===null||f===void 0?void 0:f[0])||"",publicKey:this.publicKey,authKey:null,minKeysRequired:2})}catch{return r(l)}else return r();l.data.type==="APTOS:FRAME:CLOSE"&&(u(),F(s),r(new Error("User declined the login request")))}}))})})}fetchAddress(){var e;return g(this,void 0,void 0,function*(){const r=((e=G(this.sessionKey))===null||e===void 0?void 0:e.code)||"",{accounts:i}=yield fetch(`${this.server}/api/aptos/accounts`,{headers:{"Blocto-Application-Identifier":this.appId,"Blocto-Session-Identifier":r}}).then(n=>le(n,this.sessionKey));return Br(this.sessionKey,b.APTOS,i),i?.[0]||""})}on(e,r){this.existedSDK&&this.existedSDK.on(e,r),super.on(e,r)}removeListener(e,r){this.existedSDK&&this.existedSDK.off(e,r),super.removeListener(e,r)}}class Kt{constructor({appId:e,ethereum:r,aptos:i}){r&&(this.ethereum=new Mt(Object.assign(Object.assign({},r),{appId:e}))),i&&(this.aptos=new Ut(Object.assign(Object.assign({},i),{appId:e})))}}export{Kt as B};
